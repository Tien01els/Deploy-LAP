"use strict";(self.webpackChunktemplate_react_app=self.webpackChunktemplate_react_app||[]).push([[784],{6829:function(e,t,n){n.r(t),n.d(t,{default:function(){return q}});var s=n(2982),r=n(4165),a=n(5861),c=n(885),i=n(2791),o=n(7689),l=n(8661),p=n(3458),u=n(4453),d=n(1878),x=n(7338),f=n(1413),m=n(1134),h=n(7948),v=n.n(h),g=n(4212),j=n(9085),b=n(4255),Z=n(184),N=(0,g.Z)(),w=function(e){var t=e.modalTopicIsOpen,n=e.setTopicIsOpen,s=e.handleCloseModalAddTopic,o=e.getTopicOfClass,l=e.classId,d=(0,m.cI)(),x=d.register,h=d.handleSubmit,g=d.reset,w=d.formState,k=d.watch,y=d.control,I=(0,i.useState)([]),T=(0,c.Z)(I,2),C=T[0],S=T[1],O=(0,i.useState)([]),q=(0,c.Z)(O,2),L=q[0],E=q[1],F=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.get(p.T+"grade/teacher");case 2:t=e.sent,S(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function A(){n(!1)}(0,i.useEffect)((function(){F()}),[]),(0,i.useEffect)((function(){w.isSubmitSuccessful&&(g({topicName:"",description:"",gradeId:-1,prerequisiteTopicId:-1}),A())}),[w,g]);var R=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a,c,i,u;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=null!==(n=t.prerequisiteTopicId)&&void 0!==n&&n.id?{prerequisiteTopicId:t.prerequisiteTopicId.id}:{},c=(0,f.Z)({topicName:t.topicName,description:t.description,gradeId:t.gradeId.id,isUnlock:!t.isLock},a),e.next=5,N.post(p.T+"topic",c);case 5:if(!(i=e.sent).data){e.next=10;break}return e.next=9,N.post(p.T+"class-topic",{topicId:null===(u=i.data.topic)||void 0===u?void 0:u.id,isUnlock:!t.isLock,classId:l});case 9:o();case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0),(0,j.Am)("Create topic failed");case 16:s();case 17:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),D=k("gradeId"),H=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N.get(p.T+"topic/teacher/grade/".concat(null===D||void 0===D?void 0:D.id));case 3:t=e.sent,E(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return(0,i.useEffect)((function(){H()}),[D]),(0,Z.jsxs)(v(),{isOpen:t,style:{overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(165, 165, 165, 0.6)"},content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",border:"none",borderRadius:"8px",overflow:"visible"}},contentLabel:"Example Modal",ariaHideApp:!1,children:[(0,Z.jsx)("div",{className:"flex justify-end",children:(0,Z.jsx)("button",{onClick:A,children:(0,Z.jsx)("i",{className:"fas fa-times"})})}),(0,Z.jsxs)("form",{className:"flex flex-col w-[500px] ",onSubmit:h(R),children:[(0,Z.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,Z.jsx)("div",{className:"flex justify-center",children:(0,Z.jsx)("h2",{className:"text-2xl font-semibold",children:"Create new topic"})}),(0,Z.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,Z.jsx)("label",{htmlFor:"topicName",children:"Topic name"}),(0,Z.jsx)("input",(0,f.Z)({type:"text",name:"topicName",placeholder:"Enter topic name",className:"outline-none px-3 py-1 border-b-2  border-opacity-0 transition-all focus:border-primary"},x("topicName",{required:!0})))]}),(0,Z.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,Z.jsx)("label",{htmlFor:"description",children:"Topic description"}),(0,Z.jsx)("textarea",(0,f.Z)({type:"text",name:"description",placeholder:"Description",className:"resize-none outline-none px-3 py-1 border-b-2  border-opacity-0 transition-all focus:border-primary"},x("description",{required:!0})))]}),(0,Z.jsxs)("div",{className:"flex flex-row items-center gap-3",children:[(0,Z.jsx)("input",(0,f.Z)({id:"lockTopicCreate",type:"checkbox"},x("isLock"))),(0,Z.jsx)("label",{htmlFor:"lockTopicCreate",className:"select-none cursor-pointer",children:"Lock topic"})]}),(0,Z.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,Z.jsx)("label",{htmlFor:"gradeId",children:"Grade"}),(0,Z.jsx)(m.Qr,{name:"gradeId",control:y,rules:{required:!0},render:function(e){var t=e.field;return(0,Z.jsx)(b.ZP,(0,f.Z)((0,f.Z)({},t),{},{onChange:t.onChange,options:C,getOptionValue:function(e){return e.id},getOptionLabel:function(e){return e.gradeName},styles:{menuList:function(e){return(0,f.Z)((0,f.Z)({},e),{},{maxHeight:"100px"})}}}))}})]}),(0,Z.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,Z.jsx)("label",{htmlFor:"prerequisiteTopicId",children:"Prerequisite topic"}),(null===L||void 0===L?void 0:L.length)>0&&(0,Z.jsx)(m.Qr,{name:"prerequisiteTopicId",control:y,render:function(e){var t=e.field;return(0,Z.jsx)(b.ZP,(0,f.Z)((0,f.Z)({},t),{},{options:L,getOptionValue:function(e){return e.id},getOptionLabel:function(e){return e.topicName},styles:{menuList:function(e){return(0,f.Z)((0,f.Z)({},e),{},{maxHeight:"160px"})}}}))}})]})]}),(0,Z.jsx)(u.Z,{className:"border-none bg-primary w-full mt-5",children:"Create"})]})]})},k=n(1756),y=(0,g.Z)(),I=function(e){var t=e.gradeId,n=e.classId,s=e.modalIsOpen,o=e.setIsOpen,l=e.getTopicOfClass,d=(0,m.cI)(),x=d.register,h=d.handleSubmit,g=d.reset,j=d.formState,b=(0,i.useState)(!1),N=(0,c.Z)(b,2),I=N[0],T=N[1],C=(0,i.useState)([]),S=(0,c.Z)(C,2),O=S[0],q=S[1],L=(0,i.useState)(!1),E=(0,c.Z)(L,2),F=E[0],A=E[1],R=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s={topicId:t.topicId,isUnlock:!t.isLock},e.next=4,y.post(p.T+"class-topic",(0,f.Z)((0,f.Z)({},s),{},{classId:n}));case 4:l(),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0),401===e.t0.response.status&&T(!0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),D=(0,i.useCallback)((function(){o(!1)}),[o]),H=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.get(p.T+"topic/teacher/grade/".concat(t));case 3:n=e.sent,q(n.data),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0),401===e.t0.response.status&&T(!0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),M=(0,i.useCallback)((function(){A(!0)}),[]);return(0,i.useEffect)((function(){H()}),[]),(0,i.useEffect)((function(){j.isSubmitSuccessful&&(g({topicId:-1,classId:-1}),D())}),[j,D,g]),(0,Z.jsxs)(v(),{isOpen:s,onRequestClose:function(){return D()},style:{overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(165, 165, 165, 0.6)"},content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",border:"none",borderRadius:"8px"}},contentLabel:"Example Modal",ariaHideApp:!1,children:[(0,Z.jsx)("div",{className:"relative",children:(0,Z.jsx)("button",{onClick:D,className:"absolute hover:text-red-400 transition-all text-2xl translate-x-[485px] -translate-y-[10px]",children:(0,Z.jsx)("i",{className:"fas fa-times"})})}),(0,Z.jsx)("form",{className:"flex",onSubmit:h(R),children:(0,Z.jsxs)("div",{className:"flex flex-col gap-7 w-[500px] px-6",children:[(0,Z.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,Z.jsx)("h2",{className:"text-2xl font-semibold",children:"Add topic"}),(0,Z.jsx)("label",{htmlFor:"topic",children:"Topic"}),(0,Z.jsxs)("select",(0,f.Z)((0,f.Z)({name:"classes",className:"border outline-none border-gray-500 rounded px-2",defaultValue:"-1"},x("topicId")),{},{children:[(0,Z.jsx)("option",{disabled:!0,value:"-1",children:"-- Select an topic --"}),O&&O.map((function(e){return(0,Z.jsx)("option",{value:e.id,children:e.topicName},e.id)}))]})),(0,Z.jsxs)("div",{className:"flex flex-row gap-3 px-2 items-center",children:[(0,Z.jsx)("input",(0,f.Z)({id:"lockTopic",type:"checkbox"},x("isLock"))),(0,Z.jsx)("label",{htmlFor:"lockTopic",className:"select-none cursor-pointer",children:"Lock topic"})]}),(0,Z.jsxs)("span",{className:"flex flex-row gap-1",children:["Or create",(0,Z.jsx)("span",{className:"text-primary underline-offset-2 underline cursor-pointer",onClick:M,children:"new topic"})]})]}),(0,Z.jsx)("div",{className:"flex justify-center",children:(0,Z.jsx)(u.Z,{className:"bg-primary border-none w-[50%]",children:"ADD"})})]})}),(0,Z.jsx)(w,{handleCloseModalAddTopic:D,handleCreateClassTopic:R,classId:n,modalTopicIsOpen:F,setTopicIsOpen:A,getTopicOfClass:l}),(0,Z.jsx)(k.Z,{isOpen:I})]})},T=(0,i.memo)(I),C=n(9959),S=n(4614),O=(0,g.Z)(),q=function(){var e=(0,o.UO)(),t=e.classId,n=(e.topicId,(0,i.useState)("")),f=(0,c.Z)(n,2),m=f[0],h=f[1],v=(0,i.useState)([]),g=(0,c.Z)(v,2),j=g[0],b=g[1],N=(0,i.useState)([]),w=(0,c.Z)(N,2),y=w[0],I=w[1],q=(0,i.useState)([]),L=(0,c.Z)(q,2),E=L[0],F=L[1],A=(0,i.useState)({}),R=(0,c.Z)(A,2),D=R[0],H=R[1],M=(0,i.useState)(),P=(0,c.Z)(M,2),U=P[0],_=P[1],z=(0,i.useState)(!1),V=(0,c.Z)(z,2),Q=V[0],G=V[1],B=(0,i.useState)(),J=(0,c.Z)(B,2),K=J[0],W=J[1],X=(0,i.useState)(!1),Y=(0,c.Z)(X,2),$=Y[0],ee=Y[1],te=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.post(p.T+"file/image",{image:t.target.files[0]},{headers:{"Content-Type":"multipart/form-data"}});case 2:n=e.sent,D.topicImg=n.data,Ne();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ne=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.delete(p.T+"class-topic/".concat(t));case 3:_(null),se(),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0),401===e.t0.response.status&&ee(!0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),se=(0,i.useCallback)((0,a.Z)((0,r.Z)().mark((function e(){var n,a,c,i,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.get(p.T+"class-topic/teacher/class/".concat(t));case 3:for(a=e.sent,(c=a.data).length>0&&null!==(n=c[0])&&void 0!==n&&n.topicId&&!U&&(_(c[0].topicId),H(c[0])),i=[],o=0;o<c.length;++o)i=[].concat((0,s.Z)(i),[{id:c[o].topicId,topicName:c[o].topicName,description:c[o].description,topicImg:c[o].topicImg,prerequisiteTopicName:c[o].prerequisiteTopicName,classTopicId:c[o].id}]);I(i),b(c),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0),401===e.t0.response.status&&ee(!0);case 16:case"end":return e.stop()}}),e,null,[[0,12]])}))),[t,U]);(0,i.useEffect)((function(){se()}),[se]),(0,i.useEffect)((function(){oe(D.topicName),ve(D.description)}),[D]),(0,i.useEffect)((function(){var e=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return e.next=3,O.get(p.T+"class/".concat(t));case 3:n=e.sent,W(n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();e(t)}),[t]);var re=(0,i.useRef)(null),ae=(0,i.useState)(""),ce=(0,c.Z)(ae,2),ie=ce[0],oe=ce[1],le=(0,i.useState)(!1),pe=(0,c.Z)(le,2),ue=pe[0],de=pe[1],xe=(0,i.useRef)(null),fe=(0,i.useState)(""),me=(0,c.Z)(fe,2),he=me[0],ve=me[1],ge=(0,i.useState)(!1),je=(0,c.Z)(ge,2),be=je[0],Ze=je[1],Ne=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t,n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.put(p.T+"topic/".concat(U),{topicName:null===re||void 0===re||null===(t=re.current)||void 0===t?void 0:t.value,description:null===xe||void 0===xe||null===(n=xe.current)||void 0===n?void 0:n.value,topicImg:null===D||void 0===D?void 0:D.topicImg,gradeId:null===D||void 0===D?void 0:D.gradeId,prerequisiteTopicId:null===D||void 0===D?void 0:D.prerequisiteTopicId});case 3:se(),e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0),401===e.t0.response.status&&ee(!0);case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),we=(0,i.useState)(!1),ke=(0,c.Z)(we,2),ye=ke[0],Ie=ke[1],Te=(0,i.useCallback)((0,a.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!U){e.next=7;break}return e.next=4,O.get(p.T+"skill/topic/".concat(U));case 4:t=e.sent,F(t.data),H(y.find((function(e){return e.id===U}))||{});case 7:e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0),401===e.t0.response.status&&ee(!0);case 13:case"end":return e.stop()}}),e,null,[[0,9]])}))),[U,y]);(0,i.useEffect)((function(){Te()}),[Te]);return(0,Z.jsxs)(Z.Fragment,{children:[K&&(0,Z.jsx)(T,{gradeId:K.gradeId,classId:t,modalIsOpen:Q,setIsOpen:G,getTopicOfClass:se}),(0,Z.jsx)(C.Z,{modalCreateSkillIsOpen:ye,setCreateSkillIsOpen:Ie,topicId:U,getTopicOfClass:se}),(0,Z.jsxs)("div",{className:"flex flex-row h-screen",children:[(0,Z.jsxs)("div",{className:"w-[40%] flex flex-col px-5 py-5 gap-6",children:[(0,Z.jsxs)("div",{className:"flex flex-col gap-3 px-4",children:[(0,Z.jsx)("span",{className:"text-2xl font-medium truncate",children:null===K||void 0===K?void 0:K.className}),(0,Z.jsxs)("div",{className:"flex flex-row justify-between items-center w-full",children:[(0,Z.jsx)("input",{onChange:function(e){return h(e.target.value)},className:"outline-none rounded-lg text-base px-4 py-2 w-[65%] drop-shadow-md focus:drop-shadow-lg transition-all",placeholder:"Search topics"}),(0,Z.jsx)(u.Z,{className:"border-none",onClick:function(){G(!Q)},children:"Add a Topic"})]})]}),(0,Z.jsx)("div",{className:"flex flex-col gap-7 px-4 pb-4 overflow-auto scroll-smooth",children:j.filter((function(e){return""===m||e.topicName.toLowerCase().includes(m.toLowerCase())?e:""})).map((function(e,t){return(0,Z.jsx)(d.Z,{topicInfo:e,onDeleteTopic:ne,setCurrentTopicId:_,isTeacher:!0},t)}))})]}),(0,Z.jsx)("div",{className:"flex flex-col transition-all gap-5 w-[60%] bg-white py-5 px-10 overflow-y-auto",children:U?(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)("div",{className:"flex flex-row gap-3 justify-center items-center",children:[(null===D||void 0===D?void 0:D.topicName)&&(0,Z.jsx)("input",{ref:re,size:(null===ie||void 0===ie?void 0:ie.length)||10,value:ie||"",onChange:function(e){return oe(e.target.value)},className:"text-2xl text-center font-medium max-w-[600px] text-primary outline-none px-3 transition-all border-b-2 py-2 ".concat(ue?" border-primary ":"border-transparent"," "),readOnly:!ue}),(0,Z.jsx)("i",{onClick:function(){return re.current.focus(),de(!ue),void(ue&&Ne())},className:"fa-regular fa-pen-to-square mb-1 cursor-pointer text-primary font-medium text-xl select-none active:scale-90"})]}),(0,Z.jsxs)("div",{className:"relative rounded-lg min-h-[300px] overflow-hidden flex items-center justify-center bg-center w-full select-none cursor-pointer transition-all",children:[(0,Z.jsx)("img",{src:(null===D||void 0===D?void 0:D.topicImg)||"https://thumbs.dreamstime.com/b/letter-block-word-topic-wood-background-business-concept-170764857.jpg",className:"h-[300px] object-cover w-full",alt:""}),(0,Z.jsxs)("label",{className:"absolute z-1 w-full text-transparent hover:text-white hover:bg-gray-800 flex justify-center items-center hover:bg-opacity-50 transition-all min-h-[300px] cursor-pointer",htmlFor:"image",children:[(0,Z.jsx)("input",{type:"file",id:"image",name:"image",accept:"image/*",className:"w-0 h-0 opacity-0",onChange:te}),(0,Z.jsx)("span",{className:"text-2xl",children:"Click to edit"})]})]}),D.prerequisiteTopicName&&(0,Z.jsxs)("div",{className:"flex flex-col gap-3 items-center",children:[(0,Z.jsx)("span",{className:"text-2xl font-medium text-gray-700",children:"Prerequisite Topic"}),(0,Z.jsx)("span",{className:"",children:D.prerequisiteTopicName})]}),(0,Z.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,Z.jsxs)("div",{className:"flex flex-row justify-between items-center",children:[(0,Z.jsx)("span",{className:"text-2xl font-medium text-gray-700",children:"Topic descriptions"}),(0,Z.jsx)("span",{onClick:function(){xe.current.focus(),Ze(!be),be&&Ne()},className:"mr-5 text-primary cursor-pointer active:scale-90 select-none",children:"Edit"})]}),(null===D||void 0===D?void 0:D.description)&&(0,Z.jsx)(x.Z,{ref:xe,value:he,onChange:function(e){return ve(e.target.value)},className:"text-justify",readOnly:!be,isEditing:be})]}),(0,Z.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,Z.jsxs)("div",{className:"flex flex-row justify-between items-center",children:[(0,Z.jsx)("span",{className:"text-2xl font-medium text-gray-700",children:"Skills"}),(0,Z.jsx)(u.Z,{onClick:function(){Ie(!0)},children:"Add a skill"})]}),(0,Z.jsx)("div",{className:"flex flex-col gap-1",children:E.map((function(e,t){return(0,Z.jsx)(S.Z,{val:e,getTopicOfClass:se,isTeacher:!0},e.id+t)}))})]})]}):(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsxs)("div",{className:"w-full h-full flex flex-col gap-5 items-center justify-center",children:[(0,Z.jsx)("img",{src:l,alt:"",className:"h-[300px]"}),(0,Z.jsx)("span",{className:"text-2xl font-[500] text-primary",children:"No content, choose 1 topic to view"})]})})}),(0,Z.jsx)(k.Z,{isOpen:$})]})]})}}}]);
//# sourceMappingURL=784.a4d40e00.chunk.js.map